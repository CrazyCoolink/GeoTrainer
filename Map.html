<!--// app.js
document.addEventListener('DOMContentLoaded', () => {
// 0) Make sure we’re on the page that actually has the map
const svg = document.getElementById('MapUS');
const ORDER = [ 'AK','AZ','CA','NM','NV', /* …exactly as in your CSV… */ ];
if (!svg) { console.error('No inline <svg id="MapUS"> found on this page'); return; 
}
});
// 1) Find shapes inside the inline svg
// Prefer <path>, but if your export uses <g><path>… you still want the paths:
let paths = svg.querySelectorAll('path');
console.log('path count:', paths.length);

if (paths.length === 0) {
console.warn('Found 0 <path> elements. Is your map really inline? Does it use only polygons?');
// As a fallback, try polygons:
paths = svg.querySelectorAll('polygon, polyline');
console.log('fallback polygon/polyline count:', paths.length);
}

// 2) If there are no ids yet, assign them in AK→WY order
const ABBRS50 = [
'AK','AL','AR','AZ','CA','CO','CT','DE','FL','GA',
'HI','IA','ID','IL','IN','KS','KY','LA','MA','MD',
'ME','MI','MN','MO','MS','MT','NC','ND','NE','NH',
'NJ','NM','NV','NY','OH','OK','OR','PA','RI','SC',
'SD','TN','TX','UT','VA','VT','WA','WI','WV','WY'
];

const alreadyHasAnyId = !!svg.querySelector('path[id], polygon[id], polyline[id]');
if (!alreadyHasAnyId && paths.length >= ABBRS50.length) {
paths.forEach((el, i) => { if (ABBRS50[i]) el.id = ABBRS50[i]; });
console.log('Assigned IDs to paths in AK→WY order.');
}

const NON_STATES = new Set(['AS','DC','GU','MP','PR','VI']);

// Assign IDs exactly to each path
paths.forEach((el, i) => { el.id = ABBRS50[i]; });

// Option 1: hide the 6 non-states (so clicks/colors ignore them)
NON_STATES.forEach(code => document.getElementById(code)?.setAttribute('display','none'));

// Option 2 (alternative): leave them visible but your game simply never references them.

// Test: turn CA green
document.getElementById('CA')?.classList.add('state-ok');



function colorState(abbr) {
// Try <path id="CA">, or a group <g id="CA"> if you later add groups
const el = document.getElementById(abbr)
|| document.querySelector(`#MapUS [id="${abbr}"]`);
if (!el) { console.warn('No element found for', abbr); return; }

// Add a class for CSS…
el.classList.add('state-ok');
// …and also set the attribute directly (wins over inline styles)
if (el.tagName.toLowerCase() === 'path' || el.tagName.toLowerCase() === 'polygon') {
el.setAttribute('fill', '#39b54a');
} else {
// if it's a <g>, color its children
el.querySelectorAll('path, polygon').forEach(p => p.setAttribute('fill', '#39b54a'));
}
}